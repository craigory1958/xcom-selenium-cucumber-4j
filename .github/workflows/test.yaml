

name: Test

on: [workflow_dispatch]

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
    
      - name: Checkout
        uses: actions/checkout@v2


     - name: Enable .github scripts
       run: chmod +x .github/scripts/*.sh

     - name: Decrypt .protected files
       run: .github/scripts/decryptProtectedFiles.sh ".protected/.protected"
       env:
         PROTECTED_FILES_PASSPHRASE: ${{ secrets.PROTECTED_FILES_PASSPHRASE }}


      - name: Set up JDK 1.8
        uses: actions/setup-java@v2
        with:
          java-version: '8'
          distribution: 'adopt'

      - name: Compile w/o Running Tests
        run: mvn --batch-mode -DskipTests package


      - name: Run Tests
        run: mvn --batch-mode -Dmaven.test.failure.ignore=true test

#      - name: Report
#        uses: dorny/test-reporter@v1
#        if: always()
#        with:
#          name: Maven Tests
#          path: target/surefire-reports/*.xml
#          reporter: java-junit
#          fail-on-error: true
          